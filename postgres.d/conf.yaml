init_config:

instances:
  # Polygon
  - dbm: "%%env_POLYGON_DB_MONITORING_ENABLED%%"
    host: "%%env_POLYGON_DB_HOST%%"
    port: "%%env_POLYGON_DB_PORT%%"
    username: "%%env_POLYGON_DB_USER%%"
    password: "%%env_POLYGON_DB_PASSWORD%%"
    dbname: "%%env_POLYGON_DB_NAME%%"
    disable_generic_tags: true

  # Mainnet Writer
  - dbm: "%%env_MAINNET_WRITER_DB_MONITORING_ENABLED%%"
    host: "%%env_MAINNET_WRITER_DB_HOST%%"
    port: "%%env_MAINNET_WRITER_DB_PORT%%"
    username: "%%env_MAINNET_WRITER_DB_USER%%"
    password: "%%env_MAINNET_WRITER_DB_PASSWORD%%"
    dbname: "%%env_MAINNET_WRITER_DB_NAME%%"
    disable_generic_tags: true
    custom_queries:
      - metric_prefix: mainnet_writer
        query: SELECT query, blk_read_time + blk_write_time AS io_time FROM pg_stat_statements ORDER BY io_time DESC LIMIT 50;
        columns:
          - name: query
            type: tag
          - name: io_time
            type: count


  # Mainnet Reader
  - dbm: "%%env_MAINNET_READER_DB_MONITORING_ENABLED%%"
    host: "%%env_MAINNET_READER_DB_HOST%%"
    port: "%%env_MAINNET_READER_DB_PORT%%"
    username: "%%env_MAINNET_READER_DB_USER%%"
    password: "%%env_MAINNET_READER_DB_PASSWORD%%"
    dbname: "%%env_MAINNET_READER_DB_NAME%%"
    disable_generic_tags: true
    custom_queries:
      - metric_prefix: mainnet_reader
        query: SELECT query, blk_read_time + blk_write_time AS io_time FROM pg_stat_statements ORDER BY io_time DESC LIMIT 50;
        columns:
          - name: query
            type: tag
          - name: io_time
            type: count
